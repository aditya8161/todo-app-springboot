<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Change Password</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Custom styles for password strength -->
  <style>
    .password-strength-meter {
      height: 5px;
      border-radius: 2px;
      transition: all 0.3s ease;
    }

    .strength-weak {
      background-color: #ef4444;
      width: 25%;
    }

    .strength-fair {
      background-color: #f59e0b;
      width: 50%;
    }

    .strength-good {
      background-color: #3b82f6;
      width: 75%;
    }

    .strength-strong {
      background-color: #10b981;
      width: 100%;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">
<!-- Hidden inputs - preserving original logic -->
<input type="hidden" id="userId" th:value="${session.user != null ? session.user.id : ''}">
<input type="hidden" id="authStatus" th:value="${session.user == null}">

<div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6 md:p-8">
  <!-- Header -->
  <div class="text-center mb-8">
    <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
      <i class="fas fa-key text-blue-600 text-2xl"></i>
    </div>
    <h1 class="text-2xl font-bold text-gray-800">Change Password</h1>
    <p class="text-gray-500 mt-2">Update your account password</p>
  </div>

  <!-- Current Password Field -->
  <div class="mb-6">
    <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-2">
      <i class="fas fa-lock mr-2"></i>Current Password
    </label>
    <div class="relative">
      <input
              type="password"
              id="currentPassword"
              placeholder="Enter your current password"
              class="w-full px-4 py-3 pl-11 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
      />
      <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      <button
              type="button"
              class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
              onclick="togglePasswordVisibility('currentPassword')"
      >
        <i class="fas fa-eye"></i>
      </button>
    </div>
  </div>

  <!-- New Password Field -->
  <div class="mb-6">
    <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-2">
      <i class="fas fa-key mr-2"></i>New Password
    </label>
    <div class="relative">
      <input
              type="password"
              id="newPassword"
              placeholder="Enter your new password"
              onkeyup="checkPasswordStrength()"
              required
              class="w-full px-4 py-3 pl-11 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
      />
      <i class="fas fa-key absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      <button
              type="button"
              class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
              onclick="togglePasswordVisibility('newPassword')"
      >
        <i class="fas fa-eye"></i>
      </button>
    </div>

    <!-- Password Strength Indicator -->
    <div class="mt-3">
      <small id="passwordStrength" class="text-xs text-gray-500 mt-1 block"></small>
    </div>
  </div>

  <!-- Confirm New Password Field -->
  <div class="mb-8">
    <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">
      <i class="fas fa-check-circle mr-2"></i>Confirm New Password
    </label>
    <div class="relative">
      <input
              type="password"
              id="confirmPassword"
              placeholder="Confirm your new password"
              required
              class="w-full px-4 py-3 pl-11 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
      />
      <i class="fas fa-check-circle absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      <button
              type="button"
              class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
              onclick="togglePasswordVisibility('confirmPassword')"
      >
        <i class="fas fa-eye"></i>
      </button>
    </div>
    <div id="passwordMatch" class="text-xs mt-1 hidden">
      <i class="fas fa-check text-green-500 mr-1"></i>
      <span class="text-green-500">Passwords match</span>
    </div>
  </div>

  <!-- Update Password Button -->
  <button
          onclick="changePassword()"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center mb-4"
  >
    <i class="fas fa-sync-alt mr-2"></i>
    Update Password
  </button>

  <!-- Forgot Password Link -->
  <div class="text-center">
    <a
            href="#"
            onclick="forgotPassword()"
            class="text-blue-600 hover:text-blue-800 text-sm font-medium inline-flex items-center"
    >
      <i class="fas fa-question-circle mr-2"></i>
      Forgot your password?
    </a>
  </div>

  <!-- Password Requirements Info -->
  <div class="mt-8 p-4 bg-blue-50 rounded-lg border border-blue-100">
    <h3 class="text-sm font-medium text-blue-800 mb-2">
      <i class="fas fa-info-circle mr-1"></i> Password Requirements:
    </h3>
    <ul class="text-xs text-blue-700 space-y-1">
      <li class="flex items-start">
        <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
        Minimum length 6 to 15 characters
      </li>
      <li class="flex items-start">
        <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
        At least use alphabet and number .
      </li>
      <li class="flex items-start">
        <i class="fas fa-check-circle text-green-500 mr-2 mt-0.5"></i>
        At least one number or special character(optional)
      </li>
    </ul>
  </div>
</div>

<!-- JavaScript (preserving original functionality with enhancements) -->
<!--<script>-->
<!--  // Function to toggle password visibility-->
<!--  function togglePasswordVisibility(fieldId) {-->
<!--    const passwordField = document.getElementById(fieldId);-->
<!--    const toggleIcon = passwordField.parentElement.querySelector('.fa-eye');-->

<!--    if (passwordField.type === 'password') {-->
<!--      passwordField.type = 'text';-->
<!--      toggleIcon.classList.remove('fa-eye');-->
<!--      toggleIcon.classList.add('fa-eye-slash');-->
<!--    } else {-->
<!--      passwordField.type = 'password';-->
<!--      toggleIcon.classList.remove('fa-eye-slash');-->
<!--      toggleIcon.classList.add('fa-eye');-->
<!--    }-->
<!--  }-->

<!--  // Check password match on confirm password field-->
<!--  document.getElementById('confirmPassword').addEventListener('keyup', function() {-->
<!--    const newPassword = document.getElementById('newPassword').value;-->
<!--    const confirmPassword = this.value;-->
<!--    const matchIndicator = document.getElementById('passwordMatch');-->

<!--    if (newPassword && confirmPassword) {-->
<!--      if (newPassword === confirmPassword) {-->
<!--        matchIndicator.classList.remove('hidden');-->
<!--      } else {-->
<!--        matchIndicator.classList.add('hidden');-->
<!--      }-->
<!--    } else {-->
<!--      matchIndicator.classList.add('hidden');-->
<!--    }-->
<!--  });-->

<!--  // Enhanced password strength checker-->
<!--  function checkPasswordStrength() {-->
<!--    const password = document.getElementById('newPassword').value;-->
<!--    const strengthText = document.getElementById('passwordStrengthText');-->
<!--    const strengthBar = document.getElementById('passwordStrengthBar');-->
<!--    const strengthDescription = document.getElementById('passwordStrength');-->

<!--    if (!password) {-->
<!--      strengthText.textContent = 'Weak';-->
<!--      strengthBar.className = 'password-strength-meter strength-weak';-->
<!--      strengthDescription.textContent = '';-->
<!--      return;-->
<!--    }-->

<!--    let strength = 0;-->
<!--    let message = '';-->

<!--    // Length check-->
<!--    if (password.length >= 8) strength += 1;-->

<!--    // Contains lowercase and uppercase-->
<!--    if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 1;-->

<!--    // Contains numbers-->
<!--    if (/[0-9]/.test(password)) strength += 1;-->

<!--    // Contains special characters-->
<!--    if (/[^A-Za-z0-9]/.test(password)) strength += 1;-->

<!--    // Determine strength level-->
<!--    if (strength === 0) {-->
<!--      strengthText.textContent = 'Too Short';-->
<!--      strengthBar.className = 'password-strength-meter strength-weak';-->
<!--      message = 'Password must be at least 8 characters';-->
<!--    } else if (strength === 1) {-->
<!--      strengthText.textContent = 'Weak';-->
<!--      strengthBar.className = 'password-strength-meter strength-weak';-->
<!--      message = 'Add uppercase letters and numbers';-->
<!--    } else if (strength === 2) {-->
<!--      strengthText.textContent = 'Fair';-->
<!--      strengthBar.className = 'password-strength-meter strength-fair';-->
<!--      message = 'Good, but could be stronger';-->
<!--    } else if (strength === 3) {-->
<!--      strengthText.textContent = 'Good';-->
<!--      strengthBar.className = 'password-strength-meter strength-good';-->
<!--      message = 'Strong password';-->
<!--    } else {-->
<!--      strengthText.textContent = 'Strong';-->
<!--      strengthBar.className = 'password-strength-meter strength-strong';-->
<!--      message = 'Very strong password!';-->
<!--    }-->

<!--    strengthDescription.textContent = message;-->
<!--  }-->

<!--  // Forgot password function-->
<!--  function forgotPassword() {-->
<!--    // This would typically redirect to a forgot password page-->
<!--    alert('Redirecting to password recovery page...');-->
<!--    // window.location.href = '/forgot-password';-->
<!--  }-->

<!--  // Original changePassword function (preserved)-->
<!--  function changePassword() {-->
<!--    // Your original changePassword logic here-->
<!--    console.log('Change password function called');-->
<!--  }-->
<!--</script>-->

<!-- Original script reference (preserved) -->
<script th:src="@{/js/user-password.js}"></script>
</body>
</html>